<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="e59iH93PEC" />
  
  <title>使用Vagrant配置本地开发环境 | Iversong&#39;s 个人日志</title>
  <meta name="author" content="Iversong">
  
  <meta name="description" content="我是Iversong 这是我的个人博客 关注互联网 互联网产品 发表技术相关 生活相关文章 欢迎访问！">
  
  
  <meta name="keywords" content="vagrant 跨平台 开发环境 开发工具">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="使用Vagrant配置本地开发环境"/>
  <meta property="og:site_name" content="Iversong&#39;s 个人日志"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Iversong&#39;s 个人日志" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Iversong&#39;s 个人日志</a></h1>
  <h2><a href="/">Choose a life of action not one of ostentation</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/archives">文章列表</a></li>
    
      <li><a href="/about">关于</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-20T09:14:15.000Z"><a href="/2015/04/20/vagrant-dev-env/">Apr 20 2015</a></time>
      
      
  
    <h1 class="title">使用Vagrant配置本地开发环境</h1>
  

    </header>
    <div class="entry">
      
        <p>从二零一四年开始使用vagrant+VirtualBox搭建linux开发环境，配置简单灵活，后台运行占用内存少，比vmware好用很多，果断弃用vmware转投vagrant的怀抱；无论是个人搭建开发环境还是团队统一开发环境，vagrant是最方便快捷的方式。</p>
<h3 id="问题一："><a href="#问题一：" class="headerlink" title="问题一："></a>问题一：</h3><p>但是最近在使用的时候遇到一些坑，记录下来以免下次遇到浪费时间去查找解决；经过是这样的：从家里的agrant打包了一份开发环境到公司的新电脑上，vagrant init {boxname}初始化后使用vagrant up启动虚拟机却一直启动失败，提示如下：</p>
<pre><code>D:\webroot\vagrant&gt;vagrant up
Bringing machine &apos;default&apos; up with &apos;virtualbox&apos; provider...
==&gt; default: Clearing any previously set forwarded ports...
==&gt; default: Clearing any previously set network interfaces...
==&gt; default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
==&gt; default: Forwarding ports...
    default: 22 =&gt; 2222 (adapter 1)
==&gt; default: Booting VM...
==&gt; default: Waiting for machine to boot. This may take a few minutes...
    default: SSH address: 127.0.0.1:2222
    default: SSH username: vagrant
    default: SSH auth method: private key
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    default: Warning: Connection timeout. Retrying...
    Timed out while waiting for the machine to boot. This means that
    Vagrant was unable to communicate with the guest machine within
    the configured (&quot;config.vm.boot_timeout&quot; value) time period.

    If you look above, you should be able to see the error(s)  that Vagrant had when attempting to connect to the machine. These errors are usually good hints as to what may be wrong.

    If you&apos;re using a custom box, make sure that networking is properly working and you&apos;re able to connect to the machine. It is a common problem that networking isn&apos;t setup properly in these boxes. Verify that authentication configurations are also setup properly,as well.

    If the box appears to be booting properly, you may want to increase the timeout (&quot;config.vm.boot_timeout&quot;) value.
</code></pre><p>通过查找资料，在stackowverflow上有网友也遇到过相同问题并给出解决方案如下：</p>
<ul>
<li><p>将Vagrantfile配置文件中vb.gui = true的注释去掉</p>
<pre><code>config.vm.provider &quot;virtualbox&quot; do |vb|
#   # Don&apos;t boot with headless mode
    vb.gui = true
#
#   # Use VBoxManage to customize the VM. For example to change     memory:
#   vb.customize [&quot;modifyvm&quot;, :id, &quot;--memory&quot;, &quot;1024&quot;]
 end
</code></pre></li>
<li><p>运行vagrant up 启动 virtualbox 后，GUI会给出提示</p>
<pre><code>VT-x/AMD-V硬件加速在您的系统中不可用。您的64-位虚拟机将无法检测到 64-位处理器，从而无法启动。
</code></pre></li>
<li>这是由于在BOIS中没有开启cpu虚拟化支持，重启F2或F10等进入BIOS设置Virtualization为Enable（我的Thinkpad是Security=&gt;Virtualizatio设置为Enable）； </li>
<li>电脑重启后，再次vagrant up启动虚拟机还是有一些问题，当时也没有记录下来错误信息，只记得解决方案是使用vagrant destroy将虚拟机从磁盘中删除，然后使用vagrant up命令重新创建。</li>
</ul>
<h3 id="问题二-2015-5-7更新"><a href="#问题二-2015-5-7更新" class="headerlink" title="问题二 (2015.5.7更新)"></a>问题二 (2015.5.7更新)</h3><p>vagrant启动报错The following SSH command responded with a non-zero exit status.</p>
<pre><code>D:\vagrant_web&gt;vagrant up
Bringing machine &apos;default&apos; up with &apos;virtualbox&apos; provider...
==&gt; default: Clearing any previously set forwarded ports...
==&gt; default: Clearing any previously set network interfaces...
==&gt; default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
    default: Adapter 2: hostonly
==&gt; default: Forwarding ports...
    default: 80 =&gt; 8080 (adapter 1)
    default: 3000 =&gt; 3000 (adapter 1)
    default: 22 =&gt; 2222 (adapter 1)
==&gt; default: Booting VM...
==&gt; default: Waiting for machine to boot. This may take a few minutes...
    default: SSH address: 127.0.0.1:2222
    default: SSH username: vagrant
    default: SSH auth method: private key
    default: Warning: Connection timeout. Retrying...
==&gt; default: Machine booted and ready!
==&gt; default: Checking for guest additions in VM...
==&gt; default: Configuring and enabling network interfaces...
The following SSH command responded with a non-zero exit status.
Vagrant assumes that this means the command failed!

ARPCHECK=no /sbin/ifup eth1 2&gt; /dev/null

Stdout from the command:

Device eth1 does not seem to be present, delaying initialization.

Stderr from the command:
</code></pre><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><p>虽然vagrant up启动报错，但是vagrant ssh还是能登陆虚拟机的，进入虚拟机后，执行如下命令</p>
<pre><code>sudo rm -f /etc/udev/rules.d/70-persistent-net.rules 
</code></pre><p>对， 问题就处在在持久网络设备udev规则（persistent network device udev rules）是被原VM设置好的，再用box生成新VM时，这些rules需要被更新。而这和Vagrantfile里对新VM设置private network的指令发生冲突。删除就好了。</p>
<p>vagrant reload 再次启动就OK。</p>
<p>以上问题完美解决，记录下来，避免忘记！</p>
<p><a href="https://www.vagrantup.com/" target="_blank" rel="external">Vagrant官网</a> 文档齐全.<br><a href="http://segmentfault.com/a/1190000002645737" target="_blank" rel="external">segment安装使用方法</a> 网友分享的使用说明，简单明了！</p>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/开发工具/">开发工具</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/vagrant/">vagrant</a>, <a href="/tags/虚拟机/">虚拟机</a>, <a href="/tags/开发工具/">开发工具</a>
  </div>

        <div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdPic":"","bdStyle":"0","bdSize":"16"},"share":{},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["qzone","tsina","tqq","renren","weixin"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="/search/index.html" method="get" accept-charset="utf-8">
    <input type="text" id="st-search-inpu" name="q" results="0" placeholder="search">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/IT杂谈/">IT杂谈</a><small>2</small></li>
  
    <li><a href="/categories/PHP/">PHP</a><small>1</small></li>
  
    <li><a href="/categories/产品运营/">产品运营</a><small>1</small></li>
  
    <li><a href="/categories/前端技术/">前端技术</a><small>4</small></li>
  
    <li><a href="/categories/开发工具/">开发工具</a><small>1</small></li>
  
    <li><a href="/categories/生活/">生活</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/Ajax/" style="font-size: 10px;">Ajax</a> <a href="/tags/PHP/" style="font-size: 10px;">PHP</a> <a href="/tags/VPN代理/" style="font-size: 10px;">VPN代理</a> <a href="/tags/create-react-native-app-react-native/" style="font-size: 10px;">create-react-native-app react-native</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/facebook/" style="font-size: 10px;">facebook</a> <a href="/tags/jquery/" style="font-size: 10px;">jquery</a> <a href="/tags/js/" style="font-size: 20px;">js</a> <a href="/tags/json/" style="font-size: 10px;">json</a> <a href="/tags/nodejs-前后端分离-微服务/" style="font-size: 10px;">nodejs 前后端分离 微服务</a> <a href="/tags/porxy/" style="font-size: 10px;">porxy</a> <a href="/tags/react-react-native/" style="font-size: 10px;">react react-native</a> <a href="/tags/reactjs/" style="font-size: 10px;">reactjs</a> <a href="/tags/vagrant/" style="font-size: 10px;">vagrant</a> <a href="/tags/vps-运维/" style="font-size: 10px;">vps 运维</a> <a href="/tags/上网/" style="font-size: 10px;">上网</a> <a href="/tags/产品/" style="font-size: 10px;">产品</a> <a href="/tags/代理/" style="font-size: 10px;">代理</a> <a href="/tags/工具/" style="font-size: 10px;">工具</a> <a href="/tags/开发工具/" style="font-size: 10px;">开发工具</a> <a href="/tags/插件/" style="font-size: 10px;">插件</a> <a href="/tags/生活/" style="font-size: 10px;">生活</a> <a href="/tags/科学上网/" style="font-size: 10px;">科学上网</a> <a href="/tags/翻墙/" style="font-size: 10px;">翻墙</a> <a href="/tags/虚拟机/" style="font-size: 10px;">虚拟机</a> <a href="/tags/运营/" style="font-size: 10px;">运营</a> <a href="/tags/随笔/" style="font-size: 10px;">随笔</a>
  </div>
</div>


  <iframe width="100%" height="500" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=500&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=0&uid=2489146553&verifier=a63d6d67&dpc=1"></iframe>
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2017 Iversong , Powered by <a href="http://hexo.io/" target="_blank" title="hexo"> hexo </a>,
  Theme of &nbsp; <a href="https://github.com/hexojs/hexo-theme-light" target="_blank" title="light">light</a>,
  Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a>
  
  <span>&nbsp;|&nbsp;</span>
  <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1000455927'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/z_stat.php%3Fid%3D1000455927%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</div>
<div class="clearfix"></div></footer>
  <script src="http://libs.baidu.com/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v1/st.js','_st');

  _st('install','KmytTzhuzaxbwuTHpoeX');
</script>

  <a href="https://github.com/iversong"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/c6286ade715e9bea433b4705870de482a654f78a/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f77686974655f6666666666662e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_white_ffffff.png"></a>
</body>
</html>